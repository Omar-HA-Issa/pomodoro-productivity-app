# Pomodoro Productivity App

A full-stack productivity application implementing the Pomodoro Technique with focus timers, session templates, scheduling, AI insights, and full DevOps automation using Azure DevOps Pipelines.

## Features

- **Focus Timer** – Cycles between focus/break intervals  
- **Session Templates** – Create and reuse Pomodoro presets  
- **Calendar Scheduling** – Plan sessions for specific dates  
- **Dashboard** – Track streaks, stats, daily schedule  
- **Insights** – AI sentiment analysis on completed sessions  
- **Azure Health Check & Monitoring** – `/health` endpoint + Prometheus-style metrics  
- **CI/CD via Azure DevOps** – Automated tests, coverage gates, Docker builds, and Azure deployment

---

## Tech Stack

### **Backend**
- Node.js  
- Express  
- SQLite  
- Supabase Auth  
- Jest (70%+ coverage)  
- Prometheus client  
- Dockerized for deployment

### **Frontend**
- React  
- TypeScript  
- React Router  
- Context API  

### **DevOps**
- Azure DevOps CI Pipeline  
- Azure DevOps CD Pipeline  
- Docker container build & push  
- Azure Web App for Containers (deployment target)  
- Prometheus metrics integration

---

## Prerequisites

- Node.js (v16+)  
- npm  
- Docker  
- Azure DevOps project (for CI/CD)

---

## Installation & Run

### 1. Clone the Repository
```bash
git clone https://github.com/Omar-HA-Issa/pomodoro-productivity-app.git
cd pomodoro-productivity-app
```

---

### 2. Environment & Setup
This project includes `.env.example` templates for both the backend and frontend.  

Follow these steps to set up your environment variables:

1. **Copy the templates:**
   - `backend/.env.example` → create `backend/.env`
   - `frontend/.env.example` → create `frontend/.env`

2. **Fill in the values** from each `.env.example` into your new `.env` files.

---

### 3. Install Dependencies & Run

**Backend Setup:**
```bash
cd backend
npm install
npm start
```

**Frontend Setup:**
```bash
cd frontend
npm install
npm start
```

Once both servers are running, open your browser and check that:

- Frontend runs at: http://localhost:5173  
- Backend runs at: http://localhost:8000  

---

### 4. Run Tests

```bash
cd backend
npm test
```
This will run Jest with coverage reporting.

--- 

## CI/CD with Azure DevOps

The project uses **Azure DevOps Pipelines** for full automation, including CI, CD, Docker deployment, and monitoring.

---

## Continuous Integration (CI) Pipeline

The CI pipeline performs the following tasks:

- Install Dependencies  
- Run Jest Tests  
- Generate Coverage Report  
- Fail Pipeline if Coverage < 70%  
- Build the Backend (Node.js)  
- Build the Frontend (React)  

All CI steps are defined inside:

**`azure-pipelines.yml`** (located in the project root)

---

## Continuous Deployment (CD)

The CD pipeline handles deployment through:

### **Docker Containerization**
- Builds the backend Docker image  
- Pushes the container to **Azure Container Registry (ACR)**  
- Deploys automatically to **Azure Web App for Containers**

### **Triggering**
- CD runs **only** when changes are pushed to the **main** branch  
- Secrets (registry credentials, API keys, ACR passwords) are stored securely in **Azure DevOps variable groups**

---

## Docker & Deployment

The backend service is fully containerized and can be run locally or via Azure.

### **Build Docker image:**
```bash
cd backend
docker build -t pomodoro-backend .
```

### **Run Container Locally:**
```bash
docker run -p 8000:8000 pomodoro-backend
```

- The backend is now reachable at: `http://localhost:8000`
- Azure DevOps pipelines automatically run these same steps during deployment.

---

## Monitoring & Health Checks
  
### */health* Endpoint

Returns the application's live status:

```bash
{
  "status": "ok",
  "ok": true,
  "uptime": 123.45,
  "timestamp": "2025-11-15T21:29:25.412Z"
}
```

---

## Metrics Endpoint (Prometheus):

Exposes the following monitoring metrics:

1) Request count
2) Request latency
3) Error count

These metrics can be scraped by Prometheus or connected to Grafana dashboards.

---

## File Structure

**Backend:**
- `routes/` - API endpoints (sessions, timer, schedule, dashboard, insights)
- `tests/` - Jest test files 
- `middleware/` - Authentication middleware
- `database.js` - SQLite + Supabase setup
- `pomodoro.db` - SQLite database generated by `database.js` for use in the entire app
- `server.js` - Express app

**Frontend:**
- `src/pages/` - Dashboard, Focus, Insights, Schedule, Templates
- `src/pages/auth_pages` - Login, SignUp, ResetPassword, ForgotPassword files for authentication
- `src/components/` - Navigation, ProtectedRoute
- `src/assests/` - Contains the assets for the login page and tab icon 
- `src/lib/api.ts` - Backend API client for all HTTP requests
- `src/contexts/` - AuthContext

---

## API Overview

All endpoints require authentication via Bearer token.

**Sessions**: `/api/sessions` - CRUD for session templates  
**Timer**: `/api/timer/start|pause|resume|stop` - Timer controls  
**Schedule**: `/api/schedule` - Calendar scheduling  
**Dashboard**: `/api/dashboard/overview|streak|stats` - Overview of the sessions  
**Insights**: `/api/insights/completed-sessions|analyze` - Analytics of sessions using sentiment analysis

---

## Database Overview

SQLite database (`pomodoro.db`) is auto-generated on first run with tables:
- `sessions`:  Session templates
- `timer_sessions`: Timer records with sentiment tracking
- `scheduled_sessions`: Calendar events

